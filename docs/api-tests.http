### Mariash Game Engine API Tests
### Run these requests from IntelliJ IDEA

### ===========================================
### Health Check
### ===========================================

GET http://localhost:8080/health

### ===========================================
### Game Management
### ===========================================

### Create a new game (creator joins automatically)
POST http://localhost:8080/games
Content-Type: application/json

{"playerId": "p1", "playerName": "Alice"}

> {% client.global.set("gameId", response.body.gameId); %}

### List all games
GET http://localhost:8080/games

### Get game state
GET http://localhost:8080/games/{{gameId}}

### Delete a game
DELETE http://localhost:8080/games/{{gameId}}

### ===========================================
### Join Game
### ===========================================

### Player 2 joins
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "join", "playerId": "p2", "playerName": "Bob"}}

### Player 3 joins
# POST http://localhost:8080/games/{{gameId}}/actions
POST http://localhost:8080/games/e9167d3f-1881-46b7-91f5-7e02cc846744/actions
Content-Type: application/json

{"action": {"type": "join", "playerId": "p3", "playerName": "Charlie"}}

### ===========================================
### Start and Deal
### ===========================================

### Start game
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "start", "playerId": "p1"}}

### Deal cards (two-phase mode - default)
# POST http://localhost:8080/games/{{gameId}}/actions
POST http://localhost:8080/games/440f4b13-f9b6-4e07-ac9e-180349af8bfe/actions
Content-Type: application/json

{"action": {"type": "deal", "playerId": "p1"}}

### Deal cards (non-two-phase mode)
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "deal", "playerId": "p1", "twoPhase": false}}

### ===========================================
### Two-Phase Dealing (chooser actions)
### ===========================================

### Get decision state (check if chooser must decide)
GET http://localhost:8080/games/{{gameId}}/decision

### Submit decision: Select trump (cleaner API)
POST http://localhost:8080/games/{{gameId}}/decision
Content-Type: application/json

{"playerId": "p2", "decisionType": "SELECT_TRUMP", "card": {"suit": "HEARTS", "rank": "ACE"}}

### Submit decision: Pass (cleaner API)
POST http://localhost:8080/games/{{gameId}}/decision
Content-Type: application/json

{"playerId": "p2", "decisionType": "PASS"}

### Choose trump via action (alternative method)
### Chooser places a card from hand - card's suit becomes trump
### Makes chooser the declarer, skips bidding
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "choosetrump", "playerId": "p2", "card": {"suit": "HEARTS", "rank": "ACE"}}}

### Chooser pass via action (alternative method)
### Proceeds to normal bidding
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "chooserpass", "playerId": "p2"}}

### ===========================================
### Player Hands
### ===========================================

### Get player 1's hand (returns in deal order or custom order)
GET http://localhost:8080/games/{{gameId}}/players/p1/hand

### Get player 2's hand
GET http://localhost:8080/games/{{gameId}}/players/p2/hand

### Get player 3's hand
GET http://localhost:8080/games/{{gameId}}/players/p3/hand

### Reorder player 1's hand (cards must match current hand)
PUT http://localhost:8080/games/{{gameId}}/players/p1/hand
Content-Type: application/json

{"cards": [
  {"suit": "HEARTS", "rank": "ACE"},
  {"suit": "HEARTS", "rank": "KING"},
  {"suit": "SPADES", "rank": "ACE"},
  {"suit": "SPADES", "rank": "KING"},
  {"suit": "DIAMONDS", "rank": "ACE"},
  {"suit": "DIAMONDS", "rank": "KING"},
  {"suit": "CLUBS", "rank": "ACE"},
  {"suit": "CLUBS", "rank": "KING"},
  {"suit": "HEARTS", "rank": "QUEEN"},
  {"suit": "SPADES", "rank": "QUEEN"}
]}

### Reorder hand via action (alternative method)
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "reorderhand", "playerId": "p1", "cards": [
  {"suit": "HEARTS", "rank": "ACE"},
  {"suit": "SPADES", "rank": "ACE"}
]}}

### Get bidding state
GET http://localhost:8080/games/{{gameId}}/bidding

### ===========================================
### Bidding
### ===========================================

### Place bid (GAME)
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "bid", "playerId": "p2", "gameType": "GAME"}}

### Pass
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "pass", "playerId": "p3"}}

### Pass (bidding ends)
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "pass", "playerId": "p1"}}

### ===========================================
### Talon Exchange
### ===========================================

### Get talon (declarer only)
GET http://localhost:8080/games/{{gameId}}/talon?playerId=p2

### Exchange talon
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "exchange", "playerId": "p2", "cardsToDiscard": [
  {"suit": "SPADES", "rank": "SEVEN"},
  {"suit": "SPADES", "rank": "EIGHT"}
]}}

### ===========================================
### Trump Selection
### ===========================================

### Select trump
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "trump", "playerId": "p2", "trump": "HEARTS"}}

### ===========================================
### Playing Cards
### ===========================================

### Play a card
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "play", "playerId": "p2", "card": {"suit": "HEARTS", "rank": "ACE"}}}

### Play next card
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "play", "playerId": "p3", "card": {"suit": "HEARTS", "rank": "TEN"}}}

### Play next card
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "play", "playerId": "p1", "card": {"suit": "HEARTS", "rank": "KING"}}}

### ===========================================
### New Round
### ===========================================

### Start new round
POST http://localhost:8080/games/{{gameId}}/actions
Content-Type: application/json

{"action": {"type": "newround", "playerId": "p1"}}

### ===========================================
### Real-time Updates
### ===========================================

### Poll for events (short polling - immediate response)
GET http://localhost:8080/games/{{gameId}}/events

### Poll with ETag (304 if no changes)
GET http://localhost:8080/games/{{gameId}}/events
If-None-Match: v1

### Long polling (wait up to 30s for changes)
GET http://localhost:8080/games/{{gameId}}/events
If-None-Match: v1
Prefer: wait=30

### WebSocket endpoint (use WebSocket client)
### ws://localhost:8080/games/{{gameId}}/ws

### ===========================================
### Reference
### ===========================================
# Action types: join, leave, start, deal, choosetrump, chooserpass, bid, pass, exchange, trump, play, marriage, newround, reorderhand
# Game types: GAME, SEVEN, HUNDRED, HUNDRED_SEVEN, MISERE, SLAM, TWO_SEVENS
# Suits: SPADES, CLUBS, DIAMONDS, HEARTS
# Ranks: SEVEN, EIGHT, NINE, TEN, JACK, QUEEN, KING, ACE
# Points: 7,8,9=0  J=2  Q=3  K=4  10=10  A=11
# Two-phase dealing: deal with twoPhase=true (default) pauses after chooser gets 7 cards
# Real-time updates: GET /games/{id}/events (polling) or ws://host/games/{id}/ws (WebSocket)
